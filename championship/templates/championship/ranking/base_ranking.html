{% extends "championship/base.html" %}

{% load custom_tags %}

{% block title %}Leaderboard Swiss Unity League {{ current_season.name }} - Best Magic: The Gathering Players in Switzerland{% endblock %}
{% block meta_description %}Discover the Swiss Unity League leaderboard in Magic: The Gathering. Only the best players in Switzerland qualify for the end of year Championship.{% endblock %}

{% block content %}
    <h1>Leaderboard - Swiss Unity League {{ current_season.name }}</h1>
    {% include 'championship/components/season_dropdown.html' %}
    <br>
    {% block info_text %}{% endblock %}
    <div x-data="init()">
        <input type="text" id="playerSearch" class="form-control mb-3" placeholder="Search for players..." x-model="search">
        <table class="table table-striped" id="rankingTable" aria-label="Leaderboard Swiss Unity League {{ current_season.name }}">
            <thead>
                <tr>
                    <th scope="col">Rank</th>
                    <th scope="col">SUL Points</th>
                    <th scope="col">Player Name</th>
                </tr>
            </thead>
            <tbody>
                <template x-for="player in players">
                    <tr x-show="shouldShow(player)">
                        <td aria-label="Rank">
                            <div class="d-inline text-nowrap">
                                <span x-text="player.rank"></span>
                                <template x-if="player.qualification_type == 'LEADERBOARD'">
                                    <i class="icon-star" :title="player.qualification_reason"></i>
                                </template>
                                <template x-if="player.qualification_type == 'DIRECT'">
                                    <i class="icon-trophy" :title="player.qualification_reason"></i>
                                </template>
                                <template x-for="i in player.byes">
                                    <i class="icon-shield" title="1 Bye for the Invitational tournament"></i>
                                </template>
                            </div>
                        </td>
                        <td aria-label="SUL Points" x-text="player.total_score"></td>
                        <td aria-label="Player Name"><a :href="player.url" :title="'View tournament statistics of ' + player.name" x-text="player.name"></a></td>
                    </tr>
                </template>
            </tbody>
        </table>
    </div>


    {% block scripts %}
        {{Â players|json_script:"players-data" }}
        {% include 'alpinejs.html' %}
        <script>
            function init() {
                const players = JSON.parse(document.getElementById('players-data').textContent);
                return {
                    search: '',
                    players: players,
                    shouldShow(player) {
                        return player.name.toLowerCase().indexOf(this.search.toLowerCase()) > -1
                    }
                };
            }
        </script>
    {% endblock %}

{% endblock %}
